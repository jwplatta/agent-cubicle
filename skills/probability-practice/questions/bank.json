{
  "joint_probability": {
    "marginals": {
      "easy": [
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute P(A).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 20,
            "ensure_simple_fractions": true
          },
          "query_type": "marginal_A",
          "solution_template": "P(A) = {{marginal_A}}/{{total}} = {{simplified}}",
          "hint": "Sum the row for event A, then divide by the total.",
          "topics": ["marginal_probability"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute P(B).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 30,
            "ensure_simple_fractions": true
          },
          "query_type": "marginal_B",
          "solution_template": "P(B) = {{marginal_B}}/{{total}} = {{simplified}}",
          "hint": "Sum the column for event B, then divide by the total.",
          "topics": ["marginal_probability"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nWhat is the probability of event A?",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 40,
            "ensure_simple_fractions": true
          },
          "query_type": "marginal_A",
          "solution_template": "P(A) = {{marginal_A}}/{{total}} = {{simplified}}",
          "hint": "Add up all outcomes where A occurs (entire row A), then divide by total.",
          "topics": ["marginal_probability"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nFind P(¬A).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 50,
            "ensure_simple_fractions": true
          },
          "query_type": "marginal_notA",
          "solution_template": "P(¬A) = {{marginal_notA}}/{{total}} = {{simplified}}",
          "hint": "Sum the row for ¬A (not A), then divide by the total.",
          "topics": ["marginal_probability", "complement"]
        }
      ],
      "medium": [
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute both P(A) and P(B). Are they equal?",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 30,
            "ensure_simple_fractions": true
          },
          "query_type": "marginal_both",
          "solution_template": "P(A) = {{marginal_A}}/{{total}} = {{prob_A}}\nP(B) = {{marginal_B}}/{{total}} = {{prob_B}}\n{{comparison}}",
          "hint": "Calculate each marginal probability separately, then compare.",
          "topics": ["marginal_probability", "comparison"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nVerify that P(A) + P(¬A) = 1.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 40,
            "ensure_simple_fractions": true
          },
          "query_type": "complement_law",
          "solution_template": "P(A) = {{marginal_A}}/{{total}}\nP(¬A) = {{marginal_notA}}/{{total}}\nSum = {{marginal_A}}/{{total}} + {{marginal_notA}}/{{total}} = {{total}}/{{total}} = 1 ✓",
          "hint": "Calculate P(A) and P(¬A) separately, then add them.",
          "topics": ["marginal_probability", "complement", "axioms"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute P(A ∪ B) using the formula P(A ∪ B) = P(A) + P(B) - P(A ∩ B).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 50,
            "ensure_simple_fractions": true
          },
          "query_type": "union",
          "solution_template": "P(A) = {{marginal_A}}/{{total}}\nP(B) = {{marginal_B}}/{{total}}\nP(A ∩ B) = {{joint_AB}}/{{total}}\nP(A ∪ B) = {{marginal_A}}/{{total}} + {{marginal_B}}/{{total}} - {{joint_AB}}/{{total}} = {{union_count}}/{{total}} = {{simplified}}",
          "hint": "First find the three component probabilities, then apply the inclusion-exclusion formula.",
          "topics": ["union", "inclusion_exclusion"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nWhat fraction of all outcomes are in the cell (A ∩ B)?",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 60,
            "ensure_simple_fractions": true
          },
          "query_type": "joint_AB",
          "solution_template": "P(A ∩ B) = {{joint_AB}}/{{total}} = {{simplified}}",
          "hint": "Look at the cell where row A and column B intersect.",
          "topics": ["joint_probability"]
        }
      ],
      "hard": [
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute all four joint probabilities: P(A ∩ B), P(A ∩ ¬B), P(¬A ∩ B), P(¬A ∩ ¬B). Verify they sum to 1.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 50,
            "ensure_simple_fractions": true
          },
          "query_type": "all_joints",
          "solution_template": "P(A ∩ B) = {{joint_AB}}/{{total}}\nP(A ∩ ¬B) = {{joint_A_notB}}/{{total}}\nP(¬A ∩ B) = {{joint_notA_B}}/{{total}}\nP(¬A ∩ ¬B) = {{joint_notA_notB}}/{{total}}\nSum = ({{joint_AB}} + {{joint_A_notB}} + {{joint_notA_B}} + {{joint_notA_notB}})/{{total}} = {{total}}/{{total}} = 1 ✓",
          "hint": "Each cell in the table corresponds to one joint probability. Verify all four cells sum to the total.",
          "topics": ["joint_probability", "axioms"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nShow that P(A ∪ B) = (number of outcomes with A or B or both) / total. Then verify using the inclusion-exclusion formula.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 60,
            "ensure_simple_fractions": true
          },
          "query_type": "union_verification",
          "solution_template": "Count method: Outcomes with A or B = {{union_count}}, so P(A ∪ B) = {{union_count}}/{{total}}\n\nFormula method: P(A ∪ B) = P(A) + P(B) - P(A ∩ B) = {{marginal_A}}/{{total}} + {{marginal_B}}/{{total}} - {{joint_AB}}/{{total}} = {{union_count}}/{{total}} ✓",
          "hint": "First count directly: a + b + c. Then verify using the formula.",
          "topics": ["union", "inclusion_exclusion", "counting"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nExpress each marginal probability P(A), P(¬A), P(B), P(¬B) as a sum of joint probabilities. Verify the law of total probability holds.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 40,
            "ensure_simple_fractions": true
          },
          "query_type": "total_probability_verification",
          "solution_template": "P(A) = P(A ∩ B) + P(A ∩ ¬B) = {{joint_AB}}/{{total}} + {{joint_A_notB}}/{{total}} = {{marginal_A}}/{{total}} ✓\nP(¬A) = P(¬A ∩ B) + P(¬A ∩ ¬B) = {{joint_notA_B}}/{{total}} + {{joint_notA_notB}}/{{total}} = {{marginal_notA}}/{{total}} ✓\nP(B) = P(A ∩ B) + P(¬A ∩ B) = {{joint_AB}}/{{total}} + {{joint_notA_B}}/{{total}} = {{marginal_B}}/{{total}} ✓\nP(¬B) = P(A ∩ ¬B) + P(¬A ∩ ¬B) = {{joint_A_notB}}/{{total}} + {{joint_notA_notB}}/{{total}} = {{marginal_notB}}/{{total}} ✓",
          "hint": "Each marginal is the sum of two joint probabilities. P(A) = P(A∩B) + P(A∩¬B), etc.",
          "topics": ["law_of_total_probability", "marginal_probability", "joint_probability"]
        }
      ]
    },
    "conditional": {
      "easy": [
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute P(A | B).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 20,
            "ensure_simple_fractions": true
          },
          "query_type": "conditional_A_given_B",
          "solution_template": "P(A | B) = P(A ∩ B) / P(B) = ({{joint_AB}}/{{total}}) / ({{marginal_B}}/{{total}}) = {{joint_AB}}/{{marginal_B}} = {{simplified}}",
          "hint": "P(A|B) = P(A ∩ B) / P(B). Look at the B column: what fraction has A?",
          "topics": ["conditional_probability"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute P(B | A).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 30,
            "ensure_simple_fractions": true
          },
          "query_type": "conditional_B_given_A",
          "solution_template": "P(B | A) = P(A ∩ B) / P(A) = ({{joint_AB}}/{{total}}) / ({{marginal_A}}/{{total}}) = {{joint_AB}}/{{marginal_A}} = {{simplified}}",
          "hint": "P(B|A) = P(A ∩ B) / P(A). Look at the A row: what fraction has B?",
          "topics": ["conditional_probability"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nWhat is the probability of A given that B occurred?",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 40,
            "ensure_simple_fractions": true
          },
          "query_type": "conditional_A_given_B",
          "solution_template": "P(A | B) = {{joint_AB}}/{{marginal_B}} = {{simplified}}",
          "hint": "Restrict to column B. Out of {{marginal_B}} outcomes in B, how many have A?",
          "topics": ["conditional_probability"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nFind P(¬A | B).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 50,
            "ensure_simple_fractions": true
          },
          "query_type": "conditional_notA_given_B",
          "solution_template": "P(¬A | B) = P(¬A ∩ B) / P(B) = ({{joint_notA_B}}/{{total}}) / ({{marginal_B}}/{{total}}) = {{joint_notA_B}}/{{marginal_B}} = {{simplified}}",
          "hint": "P(¬A|B) = P(¬A ∩ B) / P(B). Look at the B column: what fraction has ¬A?",
          "topics": ["conditional_probability", "complement"]
        }
      ],
      "medium": [
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute both P(A | B) and P(B | A). Are they equal?",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 30,
            "ensure_simple_fractions": true
          },
          "query_type": "conditional_both",
          "solution_template": "P(A | B) = {{joint_AB}}/{{marginal_B}} = {{prob_A_given_B}}\nP(B | A) = {{joint_AB}}/{{marginal_A}} = {{prob_B_given_A}}\n{{comparison}}",
          "hint": "Calculate each conditional probability using the appropriate marginal. They're generally not equal.",
          "topics": ["conditional_probability", "comparison"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nVerify that P(A | B) + P(¬A | B) = 1.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 40,
            "ensure_simple_fractions": true
          },
          "query_type": "conditional_complement",
          "solution_template": "P(A | B) = {{joint_AB}}/{{marginal_B}}\nP(¬A | B) = {{joint_notA_B}}/{{marginal_B}}\nSum = {{joint_AB}}/{{marginal_B}} + {{joint_notA_B}}/{{marginal_B}} = {{marginal_B}}/{{marginal_B}} = 1 ✓",
          "hint": "Given B occurred, either A or ¬A must happen. These are complementary events.",
          "topics": ["conditional_probability", "complement", "axioms"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute P(A | B) and P(A | ¬B). Which conditioning event makes A more likely?",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 50,
            "ensure_simple_fractions": true
          },
          "query_type": "conditional_comparison",
          "solution_template": "P(A | B) = {{joint_AB}}/{{marginal_B}} = {{prob_A_given_B}}\nP(A | ¬B) = {{joint_A_notB}}/{{marginal_notB}} = {{prob_A_given_notB}}\n{{comparison}}",
          "hint": "Calculate each conditional probability. Compare which denominator gives a larger fraction.",
          "topics": ["conditional_probability", "comparison"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nUse the definition P(A | B) = P(A ∩ B) / P(B) to find P(A | B), then verify by directly counting in the table.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 60,
            "ensure_simple_fractions": true
          },
          "query_type": "conditional_verification",
          "solution_template": "Formula: P(A | B) = P(A ∩ B) / P(B) = ({{joint_AB}}/{{total}}) / ({{marginal_B}}/{{total}}) = {{joint_AB}}/{{marginal_B}}\nDirect count: In column B ({{marginal_B}} outcomes), {{joint_AB}} have A, so P(A|B) = {{joint_AB}}/{{marginal_B}} ✓",
          "hint": "First use the formula with full probabilities, then simplify. Verify by looking at column B only.",
          "topics": ["conditional_probability", "counting"]
        }
      ],
      "hard": [
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute all four conditional probabilities: P(A|B), P(¬A|B), P(A|¬B), P(¬A|¬B). Verify that P(A|B) + P(¬A|B) = 1 and P(A|¬B) + P(¬A|¬B) = 1.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 50,
            "ensure_simple_fractions": true
          },
          "query_type": "all_conditionals",
          "solution_template": "P(A | B) = {{joint_AB}}/{{marginal_B}}\nP(¬A | B) = {{joint_notA_B}}/{{marginal_B}}\nP(A | ¬B) = {{joint_A_notB}}/{{marginal_notB}}\nP(¬A | ¬B) = {{joint_notA_notB}}/{{marginal_notB}}\n\nVerify: P(A|B) + P(¬A|B) = {{joint_AB}}/{{marginal_B}} + {{joint_notA_B}}/{{marginal_B}} = 1 ✓\nVerify: P(A|¬B) + P(¬A|¬B) = {{joint_A_notB}}/{{marginal_notB}} + {{joint_notA_notB}}/{{marginal_notB}} = 1 ✓",
          "hint": "Calculate each conditional probability using the appropriate column. Complementary events conditional on the same information sum to 1.",
          "topics": ["conditional_probability", "complement", "axioms"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nShow that P(A ∩ B) = P(A | B) × P(B) using the table data. Then verify the same using P(A ∩ B) = P(B | A) × P(A).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 60,
            "ensure_simple_fractions": true
          },
          "query_type": "multiplication_rule",
          "solution_template": "Method 1: P(A ∩ B) = P(A | B) × P(B) = ({{joint_AB}}/{{marginal_B}}) × ({{marginal_B}}/{{total}}) = {{joint_AB}}/{{total}} ✓\n\nMethod 2: P(A ∩ B) = P(B | A) × P(A) = ({{joint_AB}}/{{marginal_A}}) × ({{marginal_A}}/{{total}}) = {{joint_AB}}/{{total}} ✓",
          "hint": "Use the multiplication rule in both directions. The marginals should cancel out algebraically.",
          "topics": ["conditional_probability", "multiplication_rule", "joint_probability"]
        }
      ]
    },
    "bayes": {
      "easy": [
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nYou know B occurred. Use Bayes' rule to find P(A | B) from P(B | A), P(A), and P(B).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 20,
            "ensure_simple_fractions": true
          },
          "query_type": "bayes_simple",
          "solution_template": "P(B | A) = {{joint_AB}}/{{marginal_A}}\nP(A) = {{marginal_A}}/{{total}}\nP(B) = {{marginal_B}}/{{total}}\n\nP(A | B) = P(B | A) × P(A) / P(B) = ({{joint_AB}}/{{marginal_A}}) × ({{marginal_A}}/{{total}}) / ({{marginal_B}}/{{total}}) = {{joint_AB}}/{{marginal_B}} = {{simplified}}",
          "hint": "Bayes' rule: P(A|B) = P(B|A) × P(A) / P(B). Calculate each component from the table.",
          "topics": ["bayes_theorem", "conditional_probability"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute P(B | A) directly. Then verify using Bayes' rule: P(B | A) = P(A | B) × P(B) / P(A).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 30,
            "ensure_simple_fractions": true
          },
          "query_type": "bayes_reverse",
          "solution_template": "Direct: P(B | A) = {{joint_AB}}/{{marginal_A}}\n\nBayes: P(A | B) = {{joint_AB}}/{{marginal_B}}, P(B) = {{marginal_B}}/{{total}}, P(A) = {{marginal_A}}/{{total}}\nP(B | A) = ({{joint_AB}}/{{marginal_B}}) × ({{marginal_B}}/{{total}}) / ({{marginal_A}}/{{total}}) = {{joint_AB}}/{{marginal_A}} ✓",
          "hint": "First find P(B|A) by looking at row A. Then verify using the Bayes formula.",
          "topics": ["bayes_theorem", "conditional_probability"]
        }
      ],
      "medium": [
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nSuppose you observe event B. Use Bayes' theorem to update your belief about A:\n- Prior: P(A) = ?\n- Likelihood: P(B | A) = ?\n- Evidence: P(B) = ?\n- Posterior: P(A | B) = ?",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 40,
            "ensure_simple_fractions": true
          },
          "query_type": "bayes_full",
          "solution_template": "Prior: P(A) = {{marginal_A}}/{{total}}\nLikelihood: P(B | A) = {{joint_AB}}/{{marginal_A}}\nEvidence: P(B) = {{marginal_B}}/{{total}}\n\nPosterior: P(A | B) = P(B | A) × P(A) / P(B) = ({{joint_AB}}/{{marginal_A}}) × ({{marginal_A}}/{{total}}) / ({{marginal_B}}/{{total}}) = {{joint_AB}}/{{marginal_B}} = {{simplified}}",
          "hint": "Organize the calculation as: Prior × Likelihood / Evidence = Posterior.",
          "topics": ["bayes_theorem", "prior", "posterior", "likelihood"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute the odds ratio: [P(A|B) / P(¬A|B)] / [P(A|¬B) / P(¬A|¬B)]. This measures how much B affects the odds of A.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 50,
            "ensure_simple_fractions": true
          },
          "query_type": "odds_ratio",
          "solution_template": "P(A | B) = {{joint_AB}}/{{marginal_B}}, P(¬A | B) = {{joint_notA_B}}/{{marginal_B}}\nOdds of A given B = ({{joint_AB}}/{{marginal_B}}) / ({{joint_notA_B}}/{{marginal_B}}) = {{joint_AB}}/{{joint_notA_B}}\n\nP(A | ¬B) = {{joint_A_notB}}/{{marginal_notB}}, P(¬A | ¬B) = {{joint_notA_notB}}/{{marginal_notB}}\nOdds of A given ¬B = ({{joint_A_notB}}/{{marginal_notB}}) / ({{joint_notA_notB}}/{{marginal_notB}}) = {{joint_A_notB}}/{{joint_notA_notB}}\n\nOdds ratio = ({{joint_AB}}/{{joint_notA_B}}) / ({{joint_A_notB}}/{{joint_notA_notB}}) = ({{joint_AB}} × {{joint_notA_notB}}) / ({{joint_notA_B}} × {{joint_A_notB}}) = {{odds_ratio}}",
          "hint": "First find odds of A given B, then odds of A given ¬B, then take the ratio.",
          "topics": ["odds_ratio", "conditional_probability", "bayes_theorem"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nShow that P(A | B) > P(A) if and only if P(B | A) > P(B). Verify using the table.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 60,
            "ensure_simple_fractions": true
          },
          "query_type": "bayes_inequality",
          "solution_template": "P(A) = {{marginal_A}}/{{total}} = {{prob_A}}\nP(A | B) = {{joint_AB}}/{{marginal_B}} = {{prob_A_given_B}}\nComparison: P(A | B) {{comparison_A}} P(A)\n\nP(B) = {{marginal_B}}/{{total}} = {{prob_B}}\nP(B | A) = {{joint_AB}}/{{marginal_A}} = {{prob_B_given_A}}\nComparison: P(B | A) {{comparison_B}} P(B)\n\nVerified: Both inequalities go in the {{direction}} direction ✓",
          "hint": "Compare P(A|B) to P(A), and P(B|A) to P(B). The inequalities should match.",
          "topics": ["bayes_theorem", "conditional_probability", "independence"]
        }
      ],
      "hard": [
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nUse the law of total probability to compute P(B) from P(B | A) and P(B | ¬A):\nP(B) = P(B | A) × P(A) + P(B | ¬A) × P(¬A)\n\nThen use this with Bayes' rule to find P(A | B).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 50,
            "ensure_simple_fractions": true
          },
          "query_type": "bayes_total_probability",
          "solution_template": "P(B | A) = {{joint_AB}}/{{marginal_A}}, P(A) = {{marginal_A}}/{{total}}\nP(B | ¬A) = {{joint_notA_B}}/{{marginal_notA}}, P(¬A) = {{marginal_notA}}/{{total}}\n\nP(B) = ({{joint_AB}}/{{marginal_A}}) × ({{marginal_A}}/{{total}}) + ({{joint_notA_B}}/{{marginal_notA}}) × ({{marginal_notA}}/{{total}})\n     = {{joint_AB}}/{{total}} + {{joint_notA_B}}/{{total}}\n     = {{marginal_B}}/{{total}} ✓\n\nP(A | B) = P(B | A) × P(A) / P(B) = ({{joint_AB}}/{{marginal_A}}) × ({{marginal_A}}/{{total}}) / ({{marginal_B}}/{{total}}) = {{joint_AB}}/{{marginal_B}} = {{simplified}}",
          "hint": "First partition P(B) using the law of total probability, then apply Bayes' rule.",
          "topics": ["bayes_theorem", "law_of_total_probability", "conditional_probability"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nA diagnostic test scenario: Let A = \"disease present\" and B = \"test positive\".\n\nCompute:\n- Sensitivity: P(B | A) (true positive rate)\n- Specificity: P(¬B | ¬A) (true negative rate)\n- Positive predictive value: P(A | B) (precision)\n- Negative predictive value: P(¬A | ¬B)\n\nRelate PPV to sensitivity, specificity, and prevalence using Bayes' theorem.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 100,
            "ensure_simple_fractions": true
          },
          "query_type": "diagnostic_test",
          "solution_template": "Sensitivity (TPR): P(B | A) = {{joint_AB}}/{{marginal_A}} = {{sensitivity}}\nSpecificity (TNR): P(¬B | ¬A) = {{joint_notA_notB}}/{{marginal_notA}} = {{specificity}}\nPrevalence: P(A) = {{marginal_A}}/{{total}} = {{prevalence}}\n\nPositive Predictive Value: P(A | B) = {{joint_AB}}/{{marginal_B}} = {{ppv}}\nNegative Predictive Value: P(¬A | ¬B) = {{joint_notA_notB}}/{{marginal_notB}} = {{npv}}\n\nBayes verification:\nP(A | B) = P(B | A) × P(A) / P(B)\n         = Sensitivity × Prevalence / [Sensitivity × Prevalence + (1 - Specificity) × (1 - Prevalence)]\n         = ({{joint_AB}}/{{marginal_A}}) × ({{marginal_A}}/{{total}}) / ({{marginal_B}}/{{total}})\n         = {{joint_AB}}/{{marginal_B}} ✓",
          "hint": "Organize the four key metrics. Then show how PPV relates to sensitivity, specificity, and prevalence through Bayes' theorem.",
          "topics": ["bayes_theorem", "diagnostic_test", "sensitivity", "specificity", "ppv", "npv"]
        }
      ]
    },
    "independence": {
      "medium": [
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCheck if A and B are independent by testing if P(A ∩ B) = P(A) × P(B).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 30,
            "ensure_simple_fractions": true
          },
          "query_type": "independence_test",
          "solution_template": "P(A) = {{marginal_A}}/{{total}}\nP(B) = {{marginal_B}}/{{total}}\nP(A) × P(B) = ({{marginal_A}}/{{total}}) × ({{marginal_B}}/{{total}}) = {{product_num}}/{{total_squared}}\n\nP(A ∩ B) = {{joint_AB}}/{{total}}\n\n{{independence_conclusion}}",
          "hint": "Calculate P(A) × P(B) and compare to P(A ∩ B). If equal, events are independent.",
          "topics": ["independence", "joint_probability"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCheck if A and B are independent by testing if P(A | B) = P(A).",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 40,
            "ensure_simple_fractions": true
          },
          "query_type": "independence_conditional",
          "solution_template": "P(A) = {{marginal_A}}/{{total}} = {{prob_A}}\nP(A | B) = {{joint_AB}}/{{marginal_B}} = {{prob_A_given_B}}\n\n{{independence_conclusion}}",
          "hint": "If knowing B doesn't change the probability of A, then A and B are independent.",
          "topics": ["independence", "conditional_probability"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nCompute the chi-squared statistic: χ² = Σ (observed - expected)² / expected for all four cells, where expected = (row total × column total) / grand total.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 50,
            "ensure_simple_fractions": true
          },
          "query_type": "chi_squared",
          "solution_template": "Expected counts under independence:\nE(A ∩ B) = {{marginal_A}} × {{marginal_B}} / {{total}} = {{exp_AB}}\nE(A ∩ ¬B) = {{marginal_A}} × {{marginal_notB}} / {{total}} = {{exp_A_notB}}\nE(¬A ∩ B) = {{marginal_notA}} × {{marginal_B}} / {{total}} = {{exp_notA_B}}\nE(¬A ∩ ¬B) = {{marginal_notA}} × {{marginal_notB}} / {{total}} = {{exp_notA_notB}}\n\nχ² = ({{joint_AB}} - {{exp_AB}})² / {{exp_AB}} + ({{joint_A_notB}} - {{exp_A_notB}})² / {{exp_A_notB}} + ({{joint_notA_B}} - {{exp_notA_B}})² / {{exp_notA_B}} + ({{joint_notA_notB}} - {{exp_notA_notB}})² / {{exp_notA_notB}}\n   = {{chi_squared}}\n\n{{independence_interpretation}}",
          "hint": "For each cell, compute (observed - expected)² / expected, then sum. χ² = 0 means perfect independence.",
          "topics": ["independence", "chi_squared", "hypothesis_test"]
        }
      ],
      "hard": [
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nVerify all three equivalent definitions of independence:\n1. P(A ∩ B) = P(A) × P(B)\n2. P(A | B) = P(A)\n3. P(B | A) = P(B)\n\nIf any one fails, all three should fail.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 60,
            "ensure_simple_fractions": true
          },
          "query_type": "independence_all_tests",
          "solution_template": "Test 1: P(A ∩ B) ?= P(A) × P(B)\n  {{joint_AB}}/{{total}} ?= ({{marginal_A}}/{{total}}) × ({{marginal_B}}/{{total}})\n  {{joint_AB}}/{{total}} ?= {{product_num}}/{{total_squared}}\n  {{test1_result}}\n\nTest 2: P(A | B) ?= P(A)\n  {{joint_AB}}/{{marginal_B}} ?= {{marginal_A}}/{{total}}\n  {{test2_result}}\n\nTest 3: P(B | A) ?= P(B)\n  {{joint_AB}}/{{marginal_A}} ?= {{marginal_B}}/{{total}}\n  {{test3_result}}\n\n{{independence_conclusion}}",
          "hint": "Test all three conditions. They're equivalent, so they should all give the same answer.",
          "topics": ["independence", "conditional_probability", "joint_probability"]
        },
        {
          "prompt_template": "Given the contingency table:\n\n{{table}}\n\nAssume A and B were independent. Compute what the cell counts would be. Compare to actual counts to measure departure from independence.",
          "generator": "joint_table_2x2",
          "generator_params": {
            "total": 100,
            "ensure_simple_fractions": true
          },
          "query_type": "independence_expected",
          "solution_template": "Under independence, expected counts:\nE(A ∩ B) = {{marginal_A}} × {{marginal_B}} / {{total}} = {{exp_AB}}\nE(A ∩ ¬B) = {{marginal_A}} × {{marginal_notB}} / {{total}} = {{exp_A_notB}}\nE(¬A ∩ B) = {{marginal_notA}} × {{marginal_B}} / {{total}} = {{exp_notA_B}}\nE(¬A ∩ ¬B) = {{marginal_notA}} × {{marginal_notB}} / {{total}} = {{exp_notA_notB}}\n\nActual counts:\n{{joint_AB}}, {{joint_A_notB}}, {{joint_notA_B}}, {{joint_notA_notB}}\n\nDifferences:\nΔ(A ∩ B) = {{joint_AB}} - {{exp_AB}} = {{diff_AB}}\nΔ(A ∩ ¬B) = {{joint_A_notB}} - {{exp_A_notB}} = {{diff_A_notB}}\nΔ(¬A ∩ B) = {{joint_notA_B}} - {{exp_notA_B}} = {{diff_notA_B}}\nΔ(¬A ∩ ¬B) = {{joint_notA_notB}} - {{exp_notA_notB}} = {{diff_notA_notB}}\n\n{{independence_interpretation}}",
          "hint": "Expected count for each cell = (row total × column total) / grand total. Compare to observed counts.",
          "topics": ["independence", "expected_value", "chi_squared"]
        }
      ]
    }
  }
}

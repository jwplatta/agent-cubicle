services:
  claude:
    build:
      context: .
      dockerfile: Dockerfile.claude
    container_name: claude-cubicle
    stdin_open: true
    tty: true
    volumes:
      - ./config/claude:/home/claude/.claude
      - ./config/shared/BASE_AGENT.md:/home/claude/.claude/CLAUDE.md
      - /Users/jplatta/repos:/cubicle/repos
      - /Volumes/Server/Notes/my_ken:/cubicle/notes
      - ./config/obsidian-mcp-vaults.json:/home/claude/.config/obsidian-mcp/vaults.json
      - /Users/jplatta/.config/gh:/home/claude/.config/gh
      - /Users/jplatta/.config/obsidian-mcp:/home/claude/.config/obsidian-mcp
      - /Users/jplatta/repos/second_brain/obsidian-mcp:/obsidian-mcp
      - ~/.ssh:/home/claude/.ssh:ro
      - ~/.gitconfig:/home/claude/.gitconfig:ro
    environment:
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - TODOIST_TOKEN=${TODOIST_TOKEN}
      - GIT_TERMINAL_PROMPT=0
      - GIT_CONFIG_GLOBAL=/home/claude/.gitconfig-local
    extra_hosts:
      - "host.docker.internal:host-gateway"
    deploy:
      resources:
        limits:
          memory: 8G
        reservations:
          memory: 4G
    working_dir: /cubicle

  codex:
    build:
      context: .
      dockerfile: Dockerfile.codex
    container_name: codex-cubicle
    stdin_open: true
    tty: true
    volumes:
      - ./config/codex:/home/codex/.codex
      - /Users/jplatta/repos:/cubicle/repos
      - /Volumes/Server/Notes/my_ken:/cubicle/notes
      - /Users/jplatta/.config/gh:/home/codex/.config/gh
      - /Users/jplatta/.config/obsidian-mcp:/home/codex/.config/obsidian-mcp
      - ./config/obsidian-mcp-vaults.json:/home/codex/.config/obsidian-mcp/vaults.json
      - /Users/jplatta/repos/second_brain/obsidian-mcp:/obsidian-mcp
      - ~/.ssh:/home/codex/.ssh:ro
      - ~/.gitconfig:/home/codex/.gitconfig:ro
      - ./config/shared/BASE_AGENT.md:/home/codex/.codex/AGENTS.md
    environment:
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - TODOIST_TOKEN=${TODOIST_TOKEN}
    extra_hosts:
      - "host.docker.internal:host-gateway"
    deploy:
      resources:
        limits:
          memory: 8G
        reservations:
          memory: 4G
    working_dir: /cubicle

  copilot:
    build:
      context: .
      dockerfile: Dockerfile.copilot
    container_name: copilot-cubicle
    stdin_open: true
    tty: true
    volumes:
      - ./config/copilot:/home/copilot/.copilot
      - ./config/config/github-copilot:/home/copilot/.config/github-copilot
      - /Users/jplatta/repos:/cubicle/repos
      - /Volumes/Server/Notes/my_ken:/cubicle/notes
      - /Users/jplatta/.config/gh:/home/copilot/.config/gh
      - /Users/jplatta/.config/obsidian-mcp:/home/copilot/.config/obsidian-mcp
      - ./config/obsidian-mcp-vaults.json:/home/copilot/.config/obsidian-mcp/vaults.json
      - /Users/jplatta/repos/second_brain/obsidian-mcp:/obsidian-mcp
      - ~/.ssh:/home/copilot/.ssh:ro
      - ~/.gitconfig:/home/copilot/.gitconfig:ro
      - ./config/shared/BASE_AGENT.md:/home/copilot/.copilot/agents/BASE_AGENT.md
    extra_hosts:
      - "host.docker.internal:host-gateway"
    environment:
      - GITHUB_TOKEN=${COPILOT_TOKEN}
      - TODOIST_TOKEN=${TODOIST_TOKEN}
    deploy:
      resources:
        limits:
          memory: 8G
        reservations:
          memory: 4G
    working_dir: /cubicle
services:
  claude:
    build:
      context: .
      dockerfile: Dockerfile.claude
    container_name: claude-cubicle
    stdin_open: true
    tty: true
    volumes:
      - ./config/claude:/root/.claude
      - /Users/jplatta/repos:/cubicle/repos
      - /Volumes/Server/Notes/my_ken:/cubicle/notes
      - ./config/obsidian-mcp-vaults.json:/root/.config/obsidian-mcp/vaults.json
      - /Users/jplatta/.config/gh:/root/.config/gh
      - /Users/jplatta/.config/obsidian-mcp:/root/.config/obsidian-mcp
      - /Users/jplatta/repos/second_brain/obsidian-mcp:/obsidian-mcp
      - ~/.ssh:/root/.ssh:ro
      - ~/.gitconfig:/root/.gitconfig:ro
    environment:
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - TODOIST_TOKEN=${TODOIST_TOKEN}
    extra_hosts:
      - "host.docker.internal:host-gateway"
    deploy:
      resources:
        limits:
          memory: 8G
        reservations:
          memory: 4G
    working_dir: /cubicle

  codex:
    build:
      context: .
      dockerfile: Dockerfile.codex
    container_name: codex-cubicle
    stdin_open: true
    tty: true
    volumes:
      - ./config/codex:/root/.codex
      - /Users/jplatta/repos:/cubicle/repos
      - /Volumes/Server/Notes/my_ken:/cubicle/notes
      - /Users/jplatta/.config/gh:/root/.config/gh
      - /Users/jplatta/.config/obsidian-mcp:/root/.config/obsidian-mcp
      - ./config/obsidian-mcp-vaults.json:/root/.config/obsidian-mcp/vaults.json
      - /Users/jplatta/repos/second_brain/obsidian-mcp:/obsidian-mcp
      - ~/.ssh:/root/.ssh:ro
      - ~/.gitconfig:/root/.gitconfig:ro
    environment:
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - TODOIST_TOKEN=${TODOIST_TOKEN}
    extra_hosts:
      - "host.docker.internal:host-gateway"
    deploy:
      resources:
        limits:
          memory: 8G
        reservations:
          memory: 4G
    working_dir: /cubicle

  copilot:
    build:
      context: .
      dockerfile: Dockerfile.copilot
    container_name: copilot-cubicle
    stdin_open: true
    tty: true
    volumes:
      - ./config/copilot:/root/.copilot
      - /Users/jplatta/repos:/cubicle/repos
      - /Volumes/Server/Notes/my_ken:/cubicle/notes
      - /Users/jplatta/.config/gh:/root/.config/gh
      - /Users/jplatta/.config/obsidian-mcp:/root/.config/obsidian-mcp
      - ./config/obsidian-mcp-vaults.json:/root/.config/obsidian-mcp/vaults.json
      - /Users/jplatta/repos/second_brain/obsidian-mcp:/obsidian-mcp
      - ~/.ssh:/root/.ssh:ro
      - ~/.gitconfig:/root/.gitconfig:ro
    extra_hosts:
      - "host.docker.internal:host-gateway"
    environment:
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - TODOIST_TOKEN=${TODOIST_TOKEN}
    deploy:
      resources:
        limits:
          memory: 8G
        reservations:
          memory: 4G
    working_dir: /cubicle